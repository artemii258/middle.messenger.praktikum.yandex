!function(){var e={402:function(e){function t(e,t,n,i){if(!1===t||null==t||!t&&("class"===e||"style"===e))return"";if(!0===t)return" "+(i?e:e+'="'+e+'"');var r=typeof t;return"object"!==r&&"function"!==r||"function"!=typeof t.toJSON||(t=t.toJSON()),"string"==typeof t||(t=JSON.stringify(t),n||-1===t.indexOf('"'))?(n&&(t=s(t))," "+e+'="'+t+'"'):" "+e+"='"+t.replace(/'/g,"&#39;")+"'"}function n(e,t){return Array.isArray(e)?function(e,t){for(var i,r="",a="",o=Array.isArray(t),c=0;c<e.length;c++)(i=n(e[c]))&&(o&&t[c]&&(i=s(i)),r=r+a+i,a=" ");return r}(e,t):e&&"object"==typeof e?function(e){var t="",n="";for(var s in e)s&&e[s]&&i.call(e,s)&&(t=t+n+s,n=" ");return t}(e):e||""}function s(e){var t=""+e,n=r.exec(t);if(!n)return e;var s,i,a,o="";for(s=n.index,i=0;s<t.length;s++){switch(t.charCodeAt(s)){case 34:a="&quot;";break;case 38:a="&amp;";break;case 60:a="&lt;";break;case 62:a="&gt;";break;default:continue}i!==s&&(o+=t.substring(i,s)),i=s+1,o+=a}return i!==s?o+t.substring(i,s):o}var i=Object.prototype.hasOwnProperty,r=/["&<>]/;e.exports=function(e){var i,r="",a=e||{};return function(e,a,o){r=r+"<button"+(t("class",n(["button",`${e}__button`],[!1,!0]),!1,!0)+t("type",`${o}`,!0,!0))+">"+s(null==(i=`${a}`)?"":i)+"</button>"}.call(this,"classes"in a?a.classes:"undefined"!=typeof classes?classes:void 0,"label"in a?a.label:"undefined"!=typeof label?label:void 0,"type"in a?a.type:"undefined"!=typeof type?type:void 0),r}},820:function(e){function t(e,t,n,i){if(!1===t||null==t||!t&&("class"===e||"style"===e))return"";if(!0===t)return" "+(i?e:e+'="'+e+'"');var r=typeof t;return"object"!==r&&"function"!==r||"function"!=typeof t.toJSON||(t=t.toJSON()),"string"==typeof t||(t=JSON.stringify(t),n||-1===t.indexOf('"'))?(n&&(t=s(t))," "+e+'="'+t+'"'):" "+e+"='"+t.replace(/'/g,"&#39;")+"'"}function n(e,t){return Array.isArray(e)?function(e,t){for(var i,r="",a="",o=Array.isArray(t),c=0;c<e.length;c++)(i=n(e[c]))&&(o&&t[c]&&(i=s(i)),r=r+a+i,a=" ");return r}(e,t):e&&"object"==typeof e?function(e){var t="",n="";for(var s in e)s&&e[s]&&i.call(e,s)&&(t=t+n+s,n=" ");return t}(e):e||""}function s(e){var t=""+e,n=r.exec(t);if(!n)return e;var s,i,a,o="";for(s=n.index,i=0;s<t.length;s++){switch(t.charCodeAt(s)){case 34:a="&quot;";break;case 38:a="&amp;";break;case 60:a="&lt;";break;case 62:a="&gt;";break;default:continue}i!==s&&(o+=t.substring(i,s)),i=s+1,o+=a}return i!==s?o+t.substring(i,s):o}var i=Object.prototype.hasOwnProperty,r=/["&<>]/;e.exports=function(e){var s="",i=e||{};return function(e,i,r,a,o){s=s+"<div"+t("class",n([`${e}__inputs-input`],[!0]),!1,!0)+">","avatar"!==i&&"file"!==i&&(s=s+"<input"+(t("name",`${r}`,!0,!0)+t("type",`${o}`,!0,!0)+t("placeholder",`${a||""}`,!0,!0)+t("id",`${i||""}`,!0,!0))+"><label></label>"),"avatar"!==i&&"file"!==i||(s=s+"<input"+(t("name",`${r}`,!0,!0)+t("type",`${o}`,!0,!0)+t("placeholder",""+(a=""),!0,!0)+t("id",`${i}`,!0,!0))+"><label"+t("for",`${i}`,!0,!0)+">Выбрать файл на компьютере</label>"),s+="</div>"}.call(this,"classes"in i?i.classes:"undefined"!=typeof classes?classes:void 0,"id"in i?i.id:"undefined"!=typeof id?id:void 0,"name"in i?i.name:"undefined"!=typeof name?name:void 0,"placeholder"in i?i.placeholder:"undefined"!=typeof placeholder?placeholder:void 0,"type"in i?i.type:"undefined"!=typeof type?type:void 0),s}},21:function(e){function t(e,t,n,i){if(!1===t||null==t||!t&&("class"===e||"style"===e))return"";if(!0===t)return" "+(i?e:e+'="'+e+'"');var r=typeof t;return"object"!==r&&"function"!==r||"function"!=typeof t.toJSON||(t=t.toJSON()),"string"==typeof t||(t=JSON.stringify(t),n||-1===t.indexOf('"'))?(n&&(t=s(t))," "+e+'="'+t+'"'):" "+e+"='"+t.replace(/'/g,"&#39;")+"'"}function n(e,t){return Array.isArray(e)?function(e,t){for(var i,r="",a="",o=Array.isArray(t),c=0;c<e.length;c++)(i=n(e[c]))&&(o&&t[c]&&(i=s(i)),r=r+a+i,a=" ");return r}(e,t):e&&"object"==typeof e?function(e){var t="",n="";for(var s in e)s&&e[s]&&i.call(e,s)&&(t=t+n+s,n=" ");return t}(e):e||""}function s(e){var t=""+e,n=r.exec(t);if(!n)return e;var s,i,a,o="";for(s=n.index,i=0;s<t.length;s++){switch(t.charCodeAt(s)){case 34:a="&quot;";break;case 38:a="&amp;";break;case 60:a="&lt;";break;case 62:a="&gt;";break;default:continue}i!==s&&(o+=t.substring(i,s)),i=s+1,o+=a}return i!==s?o+t.substring(i,s):o}var i=Object.prototype.hasOwnProperty,r=/["&<>]/;e.exports=function(e){var i,r="",a=e||{};return function(e,a,o,c){o||(r=r+"<div"+t("class",n([`${e}__links`],[!0]),!1,!0)+"><a"+(t("class",n([`${e}__link`],[!0]),!1,!0)+t("href",`${a}`,!0,!0))+">"+s(null==(i=c)?"":i)+"</a></div>"),o&&(r=r+"<a"+(t("class",n([`${e}__link`],[!0]),!1,!0)+t("href",`${a}`,!0,!0))+">"+s(null==(i=c)?"":i)+"</a>")}.call(this,"classes"in a?a.classes:"undefined"!=typeof classes?classes:void 0,"href"in a?a.href:"undefined"!=typeof href?href:void 0,"li"in a?a.li:"undefined"!=typeof li?li:void 0,"text"in a?a.text:"undefined"!=typeof text?text:void 0),r}},462:function(e){var t=/["&<>]/;e.exports=function(e){var n,s="",i=e||{};return function(e,i){s=s+'<div class="profile__content-elem"><div class="profile__title">'+function(e){var n=""+e,s=t.exec(n);if(!s)return e;var i,r,a,o="";for(i=s.index,r=0;i<n.length;i++){switch(n.charCodeAt(i)){case 34:a="&quot;";break;case 38:a="&amp;";break;case 60:a="&lt;";break;case 62:a="&gt;";break;default:continue}r!==i&&(o+=n.substring(r,i)),r=i+1,o+=a}return r!==i?o+n.substring(r,i):o}(null==(n=i)?"":n)+"</div><"+e+"></"+e+"></div>"}.call(this,"input"in i?i.input:"undefined"!=typeof input?input:void 0,"text"in i?i.text:"undefined"!=typeof text?text:void 0),s}},131:function(e){function t(e){var t=""+e,s=n.exec(t);if(!s)return e;var i,r,a,o="";for(i=s.index,r=0;i<t.length;i++){switch(t.charCodeAt(i)){case 34:a="&quot;";break;case 38:a="&amp;";break;case 60:a="&lt;";break;case 62:a="&gt;";break;default:continue}r!==i&&(o+=t.substring(r,i)),r=i+1,o+=a}return r!==i?o+t.substring(r,i):o}var n=/["&<>]/;e.exports=function(e){var n,s="",i=e||{};return function(e,i,r,a,o,c,l,u,d,p,h,g,f,m,y,v,M){"profile"===M&&(s=s+'<div class="profile__content"><div class="profile__content-elem"><div class="profile__title">Почта</div><div class="profile__value">'+t(null==(n=a)?"":n)+'</div></div><div class="profile__content-elem"><div class="profile__title">Логин</div><div class="profile__value">'+t(null==(n=u)?"":n)+'</div></div><div class="profile__content-elem"><div class="profile__title">Имя</div><div class="profile__value">'+t(null==(n=c)?"":n)+'</div></div><div class="profile__content-elem"><div class="profile__title">Фамилия</div><div class="profile__value">'+t(null==(n=y)?"":n)+'</div></div><div class="profile__content-elem"><div class="profile__title">Имя в чате</div><div class="profile__value">'+t(null==(n=i)?"":n)+'</div></div><div class="profile__content-elem"><div class="profile__title">Телефон</div><div class="profile__value">'+t(null==(n=f)?"":n)+"</div></div></div>"),"data"===M&&(s=s+'<div class="profile__content"><form class="profile__content-form" id="data"><'+o+"><"+d+"><"+l+"><"+v+"><"+r+"><"+m+"><"+e+"></"+e+"></"+m+"></"+r+"></"+v+"></"+l+"></"+d+"></"+o+"></form></div>"),"password"===M&&(s=s+'<div class="profile__content"><form class="profile__content-form" id="password"><'+g+"><"+h+"><"+p+"><"+e+"></"+e+"></"+p+"></"+h+"></"+g+"></form></div>")}.call(this,"button"in i?i.button:"undefined"!=typeof button?button:void 0,"display_name"in i?i.display_name:"undefined"!=typeof display_name?display_name:void 0,"display_nameInput"in i?i.display_nameInput:"undefined"!=typeof display_nameInput?display_nameInput:void 0,"email"in i?i.email:"undefined"!=typeof email?email:void 0,"emailInput"in i?i.emailInput:"undefined"!=typeof emailInput?emailInput:void 0,"first_name"in i?i.first_name:"undefined"!=typeof first_name?first_name:void 0,"first_nameInput"in i?i.first_nameInput:"undefined"!=typeof first_nameInput?first_nameInput:void 0,"login"in i?i.login:"undefined"!=typeof login?login:void 0,"loginInput"in i?i.loginInput:"undefined"!=typeof loginInput?loginInput:void 0,"newPassword2Input"in i?i.newPassword2Input:"undefined"!=typeof newPassword2Input?newPassword2Input:void 0,"newPasswordInput"in i?i.newPasswordInput:"undefined"!=typeof newPasswordInput?newPasswordInput:void 0,"oldPasswordInput"in i?i.oldPasswordInput:"undefined"!=typeof oldPasswordInput?oldPasswordInput:void 0,"phone"in i?i.phone:"undefined"!=typeof phone?phone:void 0,"phoneInput"in i?i.phoneInput:"undefined"!=typeof phoneInput?phoneInput:void 0,"second_name"in i?i.second_name:"undefined"!=typeof second_name?second_name:void 0,"second_nameInput"in i?i.second_nameInput:"undefined"!=typeof second_nameInput?second_nameInput:void 0,"trigger"in i?i.trigger:"undefined"!=typeof trigger?trigger:void 0),s}},858:function(e){e.exports=function(e){var t="",n=e||{};return function(e){t+='<ul class="chats__friends">',function(){var n=e;if("number"==typeof n.length)for(var s=0,i=n.length;s<i;s++){var r=n[s];t=t+"<"+r+"> </"+r+">"}else{i=0;for(var s in n){i++;r=n[s];t=t+"<"+r+"> </"+r+">"}}}.call(this),t+="</ul>"}.call(this,"chats"in n?n.chats:"undefined"!=typeof chats?chats:void 0),t}},415:function(e){function t(e){var t=""+e,s=n.exec(t);if(!s)return e;var i,r,a,o="";for(i=s.index,r=0;i<t.length;i++){switch(t.charCodeAt(i)){case 34:a="&quot;";break;case 38:a="&amp;";break;case 60:a="&lt;";break;case 62:a="&gt;";break;default:continue}r!==i&&(o+=t.substring(r,i)),r=i+1,o+=a}return r!==i?o+t.substring(r,i):o}var n=/["&<>]/;e.exports=function(e){var n,s="",i=e||{};return function(e,i,r){s=s+'<li class="chats__friends-list"><div class="chats__friends-img"><img'+function(e,n,s,i){if(!1===n||null==n||!n&&("class"===e||"style"===e))return"";if(!0===n)return" "+(i?e:e+'="'+e+'"');var r=typeof n;return"object"!==r&&"function"!==r||"function"!=typeof n.toJSON||(n=n.toJSON()),"string"==typeof n||(n=JSON.stringify(n),s||-1===n.indexOf('"'))?(s&&(n=t(n))," "+e+'="'+n+'"'):" "+e+"='"+n.replace(/'/g,"&#39;")+"'"}("src",""+(e?"https://ya-praktikum.tech/api/v2/resources"+e.user.avatar:"https://new.kemmamed.ru/upload/staff_photo_no.jpg"),!0,!0)+'></div><div class="chats__friends-middle"><div class="chats__friends-name">'+t(null==(n=i)?"":n)+'</div><div class="chats__friends-text">'+t(null==(n=e?e.content:null)?"":n)+'</div></div><div class="chats__friends-right"><div class="chats__friends-time">'+t(null==(n=e?e.time:null)?"":n)+'</div><div class="chats__friends-count">'+t(null==(n=r)?"":n)+"   </div></div></li>"}.call(this,"last_message"in i?i.last_message:"undefined"!=typeof last_message?last_message:void 0,"title"in i?i.title:"undefined"!=typeof title?title:void 0,"unread_count"in i?i.unread_count:"undefined"!=typeof unread_count?unread_count:void 0),s}},526:function(e){function t(e,i){return Array.isArray(e)?function(e,s){for(var i,r="",a="",o=Array.isArray(s),c=0;c<e.length;c++)(i=t(e[c]))&&(o&&s[c]&&(i=n(i)),r=r+a+i,a=" ");return r}(e,i):e&&"object"==typeof e?function(e){var t="",n="";for(var i in e)i&&e[i]&&s.call(e,i)&&(t=t+n+i,n=" ");return t}(e):e||""}function n(e){var t=""+e,n=i.exec(t);if(!n)return e;var s,r,a,o="";for(s=n.index,r=0;s<t.length;s++){switch(t.charCodeAt(s)){case 34:a="&quot;";break;case 38:a="&amp;";break;case 60:a="&lt;";break;case 62:a="&gt;";break;default:continue}r!==s&&(o+=t.substring(r,s)),r=s+1,o+=a}return r!==s?o+t.substring(r,s):o}var s=Object.prototype.hasOwnProperty,i=/["&<>]/;e.exports=function(e){var s,i="",r=e||{};return function(e,r,a){i=i+"<li"+function(e,t,s,i){if(!1===t||null==t||!t&&("class"===e||"style"===e))return"";if(!0===t)return" "+(i?e:e+'="'+e+'"');var r=typeof t;return"object"!==r&&"function"!==r||"function"!=typeof t.toJSON||(t=t.toJSON()),"string"==typeof t||(t=JSON.stringify(t),s||-1===t.indexOf('"'))?(s&&(t=n(t))," "+e+'="'+t+'"'):" "+e+"='"+t.replace(/'/g,"&#39;")+"'"}("class",t(["chats__message-wrapper "+(r?"chats__message-your":"chats__message-friend")],[!0]),!1,!0)+'><div class="chats__message-text_your chats__message-text ">'+n(null==(s=e)?"":s)+"<span>"+n(null==(s=a)?"":s)+"</span></div></li>"}.call(this,"content"in r?r.content:"undefined"!=typeof content?content:void 0,"isMine"in r?r.isMine:"undefined"!=typeof isMine?isMine:void 0,"time"in r?r.time:"undefined"!=typeof time?time:void 0),i}},243:function(e){e.exports=function(e){var t="",n=e||{};return function(e){t+='<ul class="chats__message-section">',function(){var n=e;if("number"==typeof n.length)for(var s=0,i=n.length;s<i;s++){var r=n[s];t=t+"<"+r+"> </"+r+">"}else{i=0;for(var s in n){i++;r=n[s];t=t+"<"+r+"> </"+r+">"}}}.call(this),t+="</ul>"}.call(this,"messages"in n?n.messages:"undefined"!=typeof messages?messages:void 0),t}},784:function(e){function t(e,t,s,i){if(!1===t||null==t||!t&&("class"===e||"style"===e))return"";if(!0===t)return" "+(i?e:e+'="'+e+'"');var r=typeof t;return"object"!==r&&"function"!==r||"function"!=typeof t.toJSON||(t=t.toJSON()),"string"==typeof t||(t=JSON.stringify(t),s||-1===t.indexOf('"'))?(s&&(t=function(e){var t=""+e,s=n.exec(t);if(!s)return e;var i,r,a,o="";for(i=s.index,r=0;i<t.length;i++){switch(t.charCodeAt(i)){case 34:a="&quot;";break;case 38:a="&amp;";break;case 60:a="&lt;";break;case 62:a="&gt;";break;default:continue}r!==i&&(o+=t.substring(r,i)),r=i+1,o+=a}return r!==i?o+t.substring(r,i):o}(t))," "+e+'="'+t+'"'):" "+e+"='"+t.replace(/'/g,"&#39;")+"'"}var n=/["&<>]/;e.exports=function(e){var n="",s=e||{};return function(e,s,i,r,a,o,c,l,u,d){n=n+'<section class="chats"><div class="chats__block"><div class="chats__block-left"><div class="chats__item">         <'+o+'><div class="chats__input"><'+d+"><img"+t("src",`${a.magnifier}`,!0,!0)+' alt="лупа"></'+d+"><"+c+"></"+c+'></div><div class="chats__block-right"><h3 class="chats__title">Выберите чат чтобы отправить сообщение</h3></div><div class="chats__message"><div class="chats__message-header"><div class="chats__message-avatar"><div class="chats__message-img"><img'+t("src",""+(s?"https://ya-praktikum.tech/api/v2/resources"+s:"https://new.kemmamed.ru/upload/staff_photo_no.jpg"),!0,!0)+' alt="avatar"></div><div class="chats__message-name"></div></div><div class="chats__message-points"><span></span><span></span><span><ul class="chats__message-menu"><li> <img'+t("src",`${a.menu}`,!0,!0)+' alt="плюс"><'+e+"><li> <img"+t("src",`${a.menu}`,!0,!0)+' alt="крестик"><'+r+"></"+r+"></li></"+e+'></li></ul></span></div></div></div><div class="chats__message-content">                             <'+u+"></"+u+'><form class="chats__message-form"><'+l+"><"+i+"></"+i+"></"+l+"></form></div></"+o+"></div></div></div></section>"}.call(this,"addUser"in s?s.addUser:"undefined"!=typeof addUser?addUser:void 0,"avatar"in s?s.avatar:"undefined"!=typeof avatar?avatar:void 0,"button"in s?s.button:"undefined"!=typeof button?button:void 0,"deleteUser"in s?s.deleteUser:"undefined"!=typeof deleteUser?deleteUser:void 0,"images"in s?s.images:"undefined"!=typeof images?images:void 0,"link"in s?s.link:"undefined"!=typeof link?link:void 0,"list"in s?s.list:"undefined"!=typeof list?list:void 0,"message"in s?s.message:"undefined"!=typeof message?message:void 0,"messages"in s?s.messages:"undefined"!=typeof messages?messages:void 0,"search"in s?s.search:"undefined"!=typeof search?search:void 0),n}},786:function(e){e.exports=function(e){var t="",n=e||{};return function(e,n,s,i){t=t+'<section class="entrance"><h1 class="entrance__title">Добро пожаловать в наше современное приложение!</h1><div class="entrance__wrapper"><h2 class="entrance__title-sub">Вход</h2><form class="entrance__form"><div class="entrance__inputs"><'+s+"><"+i+'><div class="entrance__buttons"><'+e+"><"+n+"></"+n+"></"+e+"></div></"+i+"></"+s+"></div></form></div></section>"}.call(this,"button"in n?n.button:"undefined"!=typeof button?button:void 0,"link"in n?n.link:"undefined"!=typeof link?link:void 0,"login"in n?n.login:"undefined"!=typeof login?login:void 0,"password"in n?n.password:"undefined"!=typeof password?password:void 0),t}},918:function(e){function t(e,t,s,i){if(!1===t||null==t||!t&&("class"===e||"style"===e))return"";if(!0===t)return" "+(i?e:e+'="'+e+'"');var r=typeof t;return"object"!==r&&"function"!==r||"function"!=typeof t.toJSON||(t=t.toJSON()),"string"==typeof t||(t=JSON.stringify(t),s||-1===t.indexOf('"'))?(s&&(t=function(e){var t=""+e,s=n.exec(t);if(!s)return e;var i,r,a,o="";for(i=s.index,r=0;i<t.length;i++){switch(t.charCodeAt(i)){case 34:a="&quot;";break;case 38:a="&amp;";break;case 60:a="&lt;";break;case 62:a="&gt;";break;default:continue}r!==i&&(o+=t.substring(r,i)),r=i+1,o+=a}return r!==i?o+t.substring(r,i):o}(t))," "+e+'="'+t+'"'):" "+e+"='"+t.replace(/'/g,"&#39;")+"'"}var n=/["&<>]/;e.exports=function(e){var n="",s=e||{};return function(e,s){n=n+'<section class="error404"><div class="error404__block"><div class="error404__text">УПС.... <div>Страница не найдена</div></div><'+e+"></"+e+'></div><div class="error404__img"><img'+t("src",`${s}`,!0,!0)+"></div></section>"}.call(this,"button"in s?s.button:"undefined"!=typeof button?button:void 0,"images"in s?s.images:"undefined"!=typeof images?images:void 0),n}},93:function(e){function t(e,t,s,i){if(!1===t||null==t||!t&&("class"===e||"style"===e))return"";if(!0===t)return" "+(i?e:e+'="'+e+'"');var r=typeof t;return"object"!==r&&"function"!==r||"function"!=typeof t.toJSON||(t=t.toJSON()),"string"==typeof t||(t=JSON.stringify(t),s||-1===t.indexOf('"'))?(s&&(t=n(t))," "+e+'="'+t+'"'):" "+e+"='"+t.replace(/'/g,"&#39;")+"'"}function n(e){var t=""+e,n=s.exec(t);if(!n)return e;var i,r,a,o="";for(i=n.index,r=0;i<t.length;i++){switch(t.charCodeAt(i)){case 34:a="&quot;";break;case 38:a="&amp;";break;case 60:a="&lt;";break;case 62:a="&gt;";break;default:continue}r!==i&&(o+=t.substring(r,i)),r=i+1,o+=a}return r!==i?o+t.substring(r,i):o}var s=/["&<>]/;e.exports=function(e){var s,i="",r=e||{};return function(e,r,a,o,c){"text"===c&&(i=i+'<section class="popup"'+t("id",`popup__${r}`,!0,!0)+'><div class="popup__wrapper"><div class="popup__title">'+n(null==(s=o)?"":s)+'</div><form class="popup__form"><'+a+"><"+e+"></"+e+"></"+a+"></form></div></section>"),"file"===c&&(i=i+'<section class="popup"'+t("id",`popup__${r}`,!0,!0)+'><div class="popup__wrapper"><div class="popup__title">'+n(null==(s=o)?"":s)+'</div><form class="popup__form"><'+a+"><"+e+"></"+e+"></"+a+"></form></div></section>")}.call(this,"button"in r?r.button:"undefined"!=typeof button?button:void 0,"id"in r?r.id:"undefined"!=typeof id?id:void 0,"input"in r?r.input:"undefined"!=typeof input?input:void 0,"title"in r?r.title:"undefined"!=typeof title?title:void 0,"typeInput"in r?r.typeInput:"undefined"!=typeof typeInput?typeInput:void 0),i}},821:function(e){function t(e){var t=""+e,s=n.exec(t);if(!s)return e;var i,r,a,o="";for(i=s.index,r=0;i<t.length;i++){switch(t.charCodeAt(i)){case 34:a="&quot;";break;case 38:a="&amp;";break;case 60:a="&lt;";break;case 62:a="&gt;";break;default:continue}r!==i&&(o+=t.substring(r,i)),r=i+1,o+=a}return r!==i?o+t.substring(r,i):o}var n=/["&<>]/;e.exports=function(e){var n,s="",i=e||{};return function(e,i,r,a,o,c,l){s=s+'<section class="profile"><ul class="profile__menu"><li class="profile__item"><'+i+"></"+i+'></li><li class="profile__item"><'+l+"></"+l+'></li><li class="profile__item"><'+r+"></"+r+'></li><li class="profile__item"><'+c+"></"+c+'></li><li class="profile__item"><'+a+"></"+a+'></li></ul><div class="profile__wrapper"><div class="profile__header"><div class="profile__avatar"> <img'+function(e,n,s,i){if(!1===n||null==n||!n&&("class"===e||"style"===e))return"";if(!0===n)return" "+(i?e:e+'="'+e+'"');var r=typeof n;return"object"!==r&&"function"!==r||"function"!=typeof n.toJSON||(n=n.toJSON()),"string"==typeof n||(n=JSON.stringify(n),s||-1===n.indexOf('"'))?(s&&(n=t(n))," "+e+'="'+n+'"'):" "+e+"='"+n.replace(/'/g,"&#39;")+"'"}("src",""+(e?"https://ya-praktikum.tech/api/v2/resources"+e:"https://new.kemmamed.ru/upload/staff_photo_no.jpg"),!0,!0)+' alt="avatar"><div class="profile__hover" data-href="/profile/changeAvatar">Поменять аватар</div></div><h3 class="profile__name">'+t(null==(n=o)?"":n)+" </h3></div></div></section>"}.call(this,"avatar"in i?i.avatar:"undefined"!=typeof avatar?avatar:void 0,"chat"in i?i.chat:"undefined"!=typeof chat?chat:void 0,"data"in i?i.data:"undefined"!=typeof data?data:void 0,"exit"in i?i.exit:"undefined"!=typeof exit?exit:void 0,"first_name"in i?i.first_name:"undefined"!=typeof first_name?first_name:void 0,"password"in i?i.password:"undefined"!=typeof password?password:void 0,"profile"in i?i.profile:"undefined"!=typeof profile?profile:void 0),s}},603:function(e){function t(e,t,n,i){if(!1===t||null==t||!t&&("class"===e||"style"===e))return"";if(!0===t)return" "+(i?e:e+'="'+e+'"');var r=typeof t;return"object"!==r&&"function"!==r||"function"!=typeof t.toJSON||(t=t.toJSON()),"string"==typeof t||(t=JSON.stringify(t),n||-1===t.indexOf('"'))?(n&&(t=s(t))," "+e+'="'+t+'"'):" "+e+"='"+t.replace(/'/g,"&#39;")+"'"}function n(e,t){return Array.isArray(e)?function(e,t){for(var i,r="",a="",o=Array.isArray(t),c=0;c<e.length;c++)(i=n(e[c]))&&(o&&t[c]&&(i=s(i)),r=r+a+i,a=" ");return r}(e,t):e&&"object"==typeof e?function(e){var t="",n="";for(var s in e)s&&e[s]&&i.call(e,s)&&(t=t+n+s,n=" ");return t}(e):e||""}function s(e){var t=""+e,n=r.exec(t);if(!n)return e;var s,i,a,o="";for(s=n.index,i=0;s<t.length;s++){switch(t.charCodeAt(s)){case 34:a="&quot;";break;case 38:a="&amp;";break;case 60:a="&lt;";break;case 62:a="&gt;";break;default:continue}i!==s&&(o+=t.substring(i,s)),i=s+1,o+=a}return i!==s?o+t.substring(i,s):o}var i=Object.prototype.hasOwnProperty,r=/["&<>]/;e.exports=function(e){var s="",i=e||{};return function(e,i,r,a,o,c,l,u,d,p){s=s+'<section class="registration"><div class="registration__wrapper"><h2'+t("class",n([`${i}__title`],[!0]),!1,!0)+">Регистрация</h2><form"+t("class",n([`${i}__form`],[!0]),!1,!0)+"><div"+t("class",n([`${i}__inputs`],[!0]),!1,!0)+"><"+r+"><"+c+"><"+a+"><"+p+"><"+d+"><"+l+"><"+u+"><div"+t("class",n([`${i}__buttons`],[!0]),!1,!0)+"><"+e+"><"+o+"></"+o+"></"+e+"></div></"+u+"></"+l+"></"+d+"></"+p+"></"+a+"></"+c+"></"+r+"></div></form></div></section>"}.call(this,"button"in i?i.button:"undefined"!=typeof button?button:void 0,"classes"in i?i.classes:"undefined"!=typeof classes?classes:void 0,"email"in i?i.email:"undefined"!=typeof email?email:void 0,"first_name"in i?i.first_name:"undefined"!=typeof first_name?first_name:void 0,"link"in i?i.link:"undefined"!=typeof link?link:void 0,"login"in i?i.login:"undefined"!=typeof login?login:void 0,"password"in i?i.password:"undefined"!=typeof password?password:void 0,"passwordReplay"in i?i.passwordReplay:"undefined"!=typeof passwordReplay?passwordReplay:void 0,"phone"in i?i.phone:"undefined"!=typeof phone?phone:void 0,"second_name"in i?i.second_name:"undefined"!=typeof second_name?second_name:void 0),s}}},t={};function n(s){var i=t[s];if(void 0!==i)return i.exports;var r=t[s]={exports:{}};return e[s](r,r.exports,n),r.exports}n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,{a:t}),t},n.d=function(e,t){for(var s in t)n.o(t,s)&&!n.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e;n.g.importScripts&&(e=n.g.location+"");var t=n.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var s=t.getElementsByTagName("script");s.length&&(e=s[s.length-1].src)}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e+"../"}(),function(){"use strict";var e;!function(e){e.GET="GET",e.POST="POST",e.PUT="PUT",e.DELETE="DELETE"}(e||(e={}));class t{constructor(){this.baseURL="https://ya-praktikum.tech/api/v2/"}get=t=>this.request(`${this.baseURL}${t}`,{method:e.GET});post=(t,n)=>this.request(`${this.baseURL}${t}`,{...n,method:e.POST});put=(t,n)=>this.request(`${this.baseURL}${t}`,{...n,method:e.PUT});delete=(t,n)=>this.request(`${this.baseURL}${t}`,{...n,method:e.DELETE});request=(t,n)=>{const{headers:s={},method:i,data:r}=n;return new Promise((function(n,a){if(!i)return void a("No method");const o=new XMLHttpRequest,c=i===e.GET;o.open(i,c&&r?`${t}${function(e){if("object"!=typeof e)throw new Error("Data must be object");const t=Object.keys(e);return t.reduce(((n,s,i)=>`${n}${s}=${e[s]}${i<t.length-1?"&":""}`),"?")}(r)}`:t),Object.keys(s).forEach((e=>{o.setRequestHeader(e,s[e])})),o.withCredentials=!0,o.responseType="json",o.onabort=a,o.onerror=a,o.onreadystatechange=function(){4===o.readyState&&(200===o.status?n(o.response):a(o.response))},o.ontimeout=a;const l=r instanceof FormData?r:JSON.stringify(r);c||!r?o.send():o.send(l)}))}}var s=new class{constructor(){this.request=new t}signin(e){return this.request.post("auth/signin",e)}signup(e){return this.request.post("auth/signup",e)}read(){return this.request.get("auth/user")}changeDate(e){return this.request.put("user/profile",e)}changePassword(e){return this.request.put("user/profile/password",e)}changeAvatar(e){return this.request.put("user/profile/avatar",e)}logout(){return this.request.post("auth/logout",{headers:{accept:"application/json"}})}};class i{listeners={};on(e,t){this.listeners[e]||(this.listeners[e]=[]),this.listeners[e]?.push(t)}off(e,t){if(!this.listeners[e])throw new Error(`Нет события: ${e}`);this.listeners[e]=this.listeners[e].filter((e=>e!==t))}emit(e,...t){this.listeners[e]&&this.listeners[e].forEach((function(e){e(...t)}))}}function r(e,t){for(let n in t)if(t.hasOwnProperty(n))try{t[n].constructor===Object?t[n]=r(e[n],t[n]):e[n]=t[n]}catch(s){e[n]=t[n]}return e}function a(e,t,n){if("object"!=typeof e||null===e)return e;if("string"!=typeof t)throw new Error("path must be string");return r(e,t.split(".").reduceRight(((e,t)=>({[t]:e})),n))}let o;!function(e){e.Updated="updated"}(o||(o={}));const c=new class extends i{constructor(){super()}state={};set(e,t){a(this.state,e,t),this.emit(o.Updated,this.getState())}getState(){return this.state}};function l(e){return function(e){return"object"==typeof e&&null!==e&&e.constructor===Object&&"[object Object]"===Object.prototype.toString.call(e)}(e)||function(e){return Array.isArray(e)}(e)}function u(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const[n,s]of Object.entries(e)){const e=t[n];if(l(s)&&l(e)){if(u(s,e))continue;return!1}if(s!==e)return!1}return!0}function d(e){return function(t){let n;return class extends t{constructor(t){n=e(c.getState()),super({...t,...n}),c.on(o.Updated,(()=>{const t=e(c.getState());(!u(n,t)||t.selectedChat||t.search)&&(n=t,this.setProps({...t}))}))}}}}var p=c;var h={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let g;const f=new Uint8Array(16);function m(){if(!g&&(g="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!g))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return g(f)}const y=[];for(let e=0;e<256;++e)y.push((e+256).toString(16).slice(1));function v(e,t=0){return(y[e[t+0]]+y[e[t+1]]+y[e[t+2]]+y[e[t+3]]+"-"+y[e[t+4]]+y[e[t+5]]+"-"+y[e[t+6]]+y[e[t+7]]+"-"+y[e[t+8]]+y[e[t+9]]+"-"+y[e[t+10]]+y[e[t+11]]+y[e[t+12]]+y[e[t+13]]+y[e[t+14]]+y[e[t+15]]).toLowerCase()}var M=function(e,t,n){if(h.randomUUID&&!t&&!e)return h.randomUUID();const s=(e=e||{}).random||(e.rng||m)();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,t){n=n||0;for(let e=0;e<16;++e)t[n+e]=s[e];return t}return v(s)};let I=!1;class w{static EVENTS={INIT:"init",FLOW_CDM:"flow:component-did-mount",FLOW_CDU:"flow:component-did-update",FLOW_RENDER:"flow:render"};id=M();_element=null;constructor(e){const t=new i,{props:n,children:s}=this._getChildrenAndProps(e);this.children=s,this.props=this._makePropsProxy(n),this.eventBus=()=>t,this._registerEvents(t),t.emit(w.EVENTS.INIT)}_getChildrenAndProps(e){const t={},n={};return Object.entries(e).forEach((([e,s])=>{s instanceof w?n[e]=s:t[e]=s})),{props:t,children:n}}_addEvents(){const{events:e={}}=this.props;Object.keys(e).forEach((t=>{"FORM"===this._element?.tagName||this._element?.querySelector("form")?this._element?.addEventListener(t,e[t]):this._element?.querySelector("input")?this._element?.querySelector("input")?.addEventListener(t,e[t]):("click"!==t||I||(document.querySelector(".popup__backgraund")?.addEventListener(t,e[t]),I=!0),this._element?.addEventListener(t,e[t]))}))}_removeEvents(){const{events:e={}}=this.props;Object.keys(e).forEach((t=>{"FORM"===this._element?.tagName||this._element?.querySelector("form")?this._element?.removeEventListener(t,e[t]):this._element?.querySelector("input")?this._element?.querySelector("input")?.removeEventListener(t,e[t]):this._element?.removeEventListener(t,e[t])}))}_registerEvents(e){e.on(w.EVENTS.INIT,this._init.bind(this)),e.on(w.EVENTS.FLOW_CDM,this._componentDidMount.bind(this)),e.on(w.EVENTS.FLOW_CDU,this._componentDidUpdate.bind(this)),e.on(w.EVENTS.FLOW_RENDER,this._render.bind(this))}_init(){this.init(),this.eventBus().emit(w.EVENTS.FLOW_RENDER)}init(){}_componentDidMount(){this.componentDidMount()}componentDidMount(){}dispatchComponentDidMount(){this.eventBus().emit(w.EVENTS.FLOW_CDM),Object.values(this.children).forEach((e=>{Array.isArray(e)?e.forEach((e=>e.dispatchComponentDidMount())):e.dispatchComponentDidMount()}))}_componentDidUpdate(e,t){this.componentDidUpdate(e,t)&&this.eventBus().emit(w.EVENTS.FLOW_RENDER)}componentDidUpdate(e,t){return e!==t}setProps=e=>{e&&Object.assign(this.props,e)};get element(){return this._element}_render(){const e=this.render().firstElementChild;this._element&&e&&this._element.replaceWith(e),this._element=e,this._removeEvents(),this._addEvents()}compile(e,t){const n={...t};Object.entries(this.children).forEach((([e,t])=>{Array.isArray(t)?n[e]=t.map((e=>`div data-id="${e.id}"></div`)):n[e]=`div data-id="${t.id}"></div`}));const s=e(n),i=document.createElement("template");i.innerHTML=s;const r=e=>{const t=i.content.querySelector(`[data-id="${e.id}"]`);t&&(e.getContent()?.append(...Array.from(t.childNodes)),t.replaceWith(e.getContent()))};return Object.entries(this.children).forEach((([e,t])=>{Array.isArray(t)?t.forEach(r):r(t)})),i.content}render(){return new DocumentFragment}getContent(){if(/\/error404/.test(window.location.pathname)){document.querySelector(".popup__backgraund").style.display="none"}else if("popup"===this._element?.getAttribute("class")||/\/addUser/.test(window.location.pathname)||/\/deleteUser/.test(window.location.pathname)){document.querySelector(".popup__backgraund").style.display="block"}else{document.querySelector(".popup__backgraund").style.display="none"}return this.element}_makePropsProxy(e){const t=this;return new Proxy(e,{get(e,t){const n=e[t];return"function"==typeof n?n.bind(e):n},set(e,n,s){const i={...e};return e[n]=s,t.eventBus().emit(w.EVENTS.FLOW_CDU,i,e),!0},deleteProperty(){throw new Error("Нет доступа")}})}}var A=n(402),N=n.n(A);class b extends w{constructor(e){super({type:"button",...e})}render(){return this.compile(N(),{...this.props})}}var _=n(462),D=n.n(_);class x{onFocus=e=>{this.checkInput(e)};onBlur=e=>{this.checkInput(e)};checkInput=e=>{const t=e.target;switch(t.name){case"email":this.email(t);break;case"login":case"display_name":this.login(t);break;case"first_name":case"second_name":this.firstNameOrSecondName(t);break;case"phone":this.phone(t);break;case"message":this.message(t);break;case"password":case"oldPassword":case"newPassword":this.password(t);break;case"newPasswordRepeat":this.passwordRepeat(t)}};email=e=>{/^[\w]+@[\w]+\.[A-Za-z]{2,}$/i.test(e.value)?(e.classList.remove("validation"),e.nextSibling&&(e.nextSibling.textContent="")):(e.nextSibling&&(e.nextSibling.textContent="латиница, может включать цифры и спецсимволы вроде дефиса, обязательно должна быть «собака» (@) и точка после неё, но перед точкой обязательно должны быть буквы"),e.classList.add("validation"))};login=e=>{/^[\w\S]{3,20}$/i.test(e.value)&&e.value.match(/\D/gi)?.length&&!e.value.match(/[`~!@#$%^&*()|+\=?;:'",.<>\{\}\[\]\\\/]/gi)?.length?(e.classList.remove("validation"),e.nextSibling&&(e.nextSibling.textContent="")):(e.nextSibling&&(e.nextSibling.textContent="от 3 до 20 символов, латиница, может содержать цифры, но не состоять из них, без пробелов, без спецсимволов (допустимы дефис и нижнее подчёркивание)"),e.classList.add("validation"))};firstNameOrSecondName=e=>{!/^[A-Z][A-Za-z]+$/.test(e.value)&&!/^[А-Я][А-Яа-яЁё]+$/.test(e.value)||e.value.match(/[`~!@#$%^&*()|+\=_?;:'",.<>\{\}\[\]\\\/]/gi)?.length?(e.nextSibling&&(e.nextSibling.textContent="латиница или кириллица, первая буква должна быть заглавной, без пробелов и без цифр, нет спецсимволов (допустим только дефис)"),e.classList.add("validation")):(e.nextSibling&&(e.nextSibling.textContent=""),e.classList.remove("validation"))};password=e=>{/\w{8,40}/.test(e.value)&&e.value.match(/[A-Z]/g)&&e.value.match(/\d/g)?(e.nextSibling&&(e.nextSibling.textContent=""),e.classList.remove("validation")):(e.nextSibling&&(e.nextSibling.textContent="от 8 до 40 символов, обязательно хотя бы одна заглавная буква и цифра"),e.classList.add("validation"))};passwordRepeat=e=>{/\w{8,40}/.test(e.value)&&e.value.match(/[A-Z]/g)&&e.value.match(/\d/g)?(e.nextSibling&&(e.nextSibling.textContent=""),e.classList.remove("validation")):(e.nextSibling&&(e.nextSibling.textContent="пароль не совпадает"),e.classList.add("validation"))};phone=e=>{/^\+?\d{10,15}$/.test(e.value)?(e.nextSibling&&(e.nextSibling.textContent=""),e.classList.remove("validation")):(e.nextSibling&&(e.nextSibling.textContent="от 10 до 15 символов, состоит из цифр, может начинается с плюса"),e.classList.add("validation"))};message=e=>{0!==e.value.length?(e.nextSibling&&(e.nextSibling.textContent=""),e.classList.remove("validationMessage")):(e.nextSibling&&(e.nextSibling.textContent="не должно быть пустым"),e.classList.add("validationMessage"))}}var j=n(820),S=n.n(j);class k extends w{constructor(e){super({...e,events:{...e.events,focus:(new x).onFocus,blur:(new x).onBlur}})}render(){return this.compile(S(),{...this.props})}}class L extends w{constructor(e){super({...e})}init(){this.children.input=new k({name:this.props.name,classes:"profile",type:this.props.type,placeholder:this.props.placeholder})}render(){return this.compile(D(),{...this.props})}}var C=n(131),O=n.n(C);const T=(e,t)=>{const n=document.querySelector(`#${t}`),s=n?.querySelectorAll("input");if(e.preventDefault(),s)for(let e=0;e<s.length;e++)if(s[e].classList.contains("validation")||""===s[e].value)return;if(n){const e=new FormData(n);let t;e.get("email")?(t={email:e.get("email"),login:e.get("login"),first_name:e.get("first_name"),second_name:e.get("second_name"),display_name:e.get("display_name"),phone:e.get("phone")},Le.changeDate(t)):(t={oldPassword:e.get("oldPassword"),newPassword:e.get("newPassword")},Le.changePassword(t))}},E=d((e=>({...e.user})))(class extends w{constructor(e){super({...e})}init(){this.children.emailInput=new L({text:"Почта",name:"email",type:"email",placeholder:"pochta@yandex.ru"}),this.children.loginInput=new L({text:"Логин",name:"login",type:"text",placeholder:"ivanivanov"}),this.children.first_nameInput=new L({text:"Имя",name:"first_name",type:"text",placeholder:"Иван"}),this.children.second_nameInput=new L({text:"Фамилия",name:"second_name",type:"text",placeholder:"Иванов"}),this.children.display_nameInput=new L({text:"Имя в чате",name:"display_name",type:"text",placeholder:"Иван"}),this.children.phoneInput=new L({text:"Телефон",name:"phone",type:"tel",placeholder:"+7 (909) 967 30 30"}),this.children.oldPasswordInput=new L({text:"Старый пароль",name:"oldPassword",type:"password",placeholder:""}),this.children.newPasswordInput=new L({text:"Новый пароль",name:"newPassword",type:"password",placeholder:""}),this.children.newPassword2Input=new L({text:"Повторите новый пароль",name:"newPasswordRepeat",type:"password",placeholder:""}),this.children.button=new b({label:"Сохранить",classes:"profile",type:"submit"})}render(){return this.compile(O(),{...this.props})}});var z=n(21),U=n.n(z);class P extends w{constructor(e){super({...e,events:{click:(new ke).onClick}})}render(){return this.compile(U(),{...this.props})}}var Q=n.p+"images/picture.png",Z=n(784),R=n.n(Z),Y=n(858),J=n.n(Y),B=n(415),W=n.n(B);const q=d((e=>({selectedChat:(e.search||[]).find(((t,n)=>e.selectedChat===t.id&&(document.querySelectorAll(".chats__friends-list")[n]?.classList.add("background-link"),t.id===e.selectedChat)))})))(class extends w{constructor(e){super(e)}render(){return this.compile(W(),{...this.props,isSelected:this.props.id===this.props.selectedChat?.id})}});var V=new class{constructor(){this.request=new t}create(e){return this.request.post("chats",{headers:{accept:"application/json","Content-Type":"application/json"},data:{title:e}})}delete(e){return this.request.delete("chats",{headers:{accept:"application/json","Content-Type":"application/json"},data:{chatId:e}})}read(){return this.request.get("chats")}getUsers(e){return this.request.get(`chats/${e}/users`)}addUsers(e,t){return this.request.put("chats/users",{users:t,chatId:e})}async getToken(e){return(await this.request.post(`chats/token/${e}`)).token}update=void 0};let G;!function(e){e.Connected="connected",e.Error="error",e.Message="message",e.Close="close"}(G||(G={}));class F extends i{socket=null;constructor(e){super(),this.url=e}send(e){if(!this.socket)throw new Error("Socket is not connected");this.socket.send(JSON.stringify(e))}connect(){return this.socket=new WebSocket(this.url),this.subscribe(this.socket),this.setupPing(),new Promise((e=>{this.on(G.Connected,(()=>{e()}))}))}close(){this.socket?.close()}setupPing(){this.pingInterval=setInterval((()=>{this.send({type:"ping"})}),5e3),this.on(G.Close,(()=>{clearInterval(this.pingInterval),this.pingInterval=0}))}subscribe(e){e.addEventListener("open",(()=>{this.emit(G.Connected)})),e.addEventListener("close",(()=>{this.emit(G.Close)})),e.addEventListener("error",(e=>{this.emit(G.Error,e)})),e.addEventListener("message",(e=>{const t=JSON.parse(e.data);t.type&&"pong"===t.type||this.emit(G.Message,t)}))}}const H=new class{sockets=new Map;async connect(e,t){if(this.sockets.has(e))return;const n=p.getState().user.id,s=new F(`wss://ya-praktikum.tech/ws/chats/${n}/${e}/${t}`);this.sockets.set(e,s),await s.connect(),this.subscribe(s,e),this.fetchOldMessages(e)}sendMessage(e,t){const n=this.sockets.get(e);if(!n)throw new Error(`Chat ${e} is not connected`);n.send({type:"message",content:t})}fetchOldMessages(e){const t=this.sockets.get(e);if(!t)throw new Error(`Chat ${e} is not connected`);t.send({type:"get old",content:"0"})}closeAll(){Array.from(this.sockets.values()).forEach((e=>e.close()))}onMessage(e,t){let n=[];Array.isArray(t)?n=t.reverse():n.push(t);n=[...(p.getState().messages||{})[e]||[],...n],p.set(`messages.${e}`,n)}onClose(e){this.sockets.delete(e)}subscribe(e,t){e.on(G.Message,(e=>this.onMessage(t,e))),e.on(G.Close,(()=>this.onClose(t)))}};const $=new class{constructor(){this.api=V}async create(e,t){await this.api.create(e).then((()=>{t.value=""})),this.fetchChats()}async fetchChats(){const e=await this.api.read();e.map((async e=>{const t=await this.getToken(e.id);await H.connect(e.id,t)})),p.set("chats",e),p.set("search",e)}addUserToChat(e,t){this.api.addUsers(e,[t])}async delete(e,t){await this.api.delete(+e).then((e=>{t.value="",console.log(e)})).catch((e=>console.log(e))),this.fetchChats()}getToken(e){return this.api.getToken(e)}selectChat(e){p.set("selectedChat",e)}};const X=d((e=>(e.selectedChat&&document.querySelector(".chats__message-form")&&document.querySelector(".chats__block-right")&&(document.querySelector(".chats__message-form").style.display="flex",document.querySelector(".chats__block-right").style.display="none"),e.selectedChat?{chats:[...e.search||[]],selectedChat:{...e.selectedChat}}:{chats:[...e.search||[]]})))(class extends w{constructor(e){super({...e})}init(){this.children.chats=this.createChats(this.props)}componentDidUpdate(e,t){return this.children.chats=this.createChats(t),!0}createChats(e){return e.chats.map((e=>{const t=new Date(e.last_message?.time).getHours(),n=new Date(e.last_message?.time).getMinutes();return{...e,last_message:e.last_message?{...e.last_message,time:`${t<10?"0"+t:t}:${n<10?"0"+n:n}`}:null}})).map((e=>new q({...e,events:{click:()=>{$.selectChat(e.id),document.querySelector(".chats__message-form").style.display="flex",document.querySelector(".chats__block-right").style.display="none"}}})))}render(){return this.compile(J(),{...this.props})}});var K=n(243),ee=n.n(K),te=n(526),ne=n.n(te);class se extends w{constructor(e){super(e)}render(){return this.compile(ne(),{...this.props})}}const ie=d((e=>{const t=e.selectedChat;return t?{messages:(e.messages||{})[t]||[],selectedChat:e.selectedChat,userId:e.user?.id}:{messages:[],selectedChat:void 0,userId:e.user?.id}}))(class extends w{constructor(e){super(e)}init(){this.children.messages=this.createMessages(this.props)}componentDidUpdate(e,t){return this.children.messages=this.createMessages(t),!0}createMessages(e){return e.messages.map((t=>{const n=new Date(t.time).getHours(),s=new Date(t.time).getMinutes(),i={...t,time:`${n<10?"0"+n:n}:${s<10?"0"+s:s}`};return new se({...i,isMine:e.userId===t.user_id})}))}render(){return this.compile(ee(),{...this.props})}}),re={magnifier:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA0AAAAOCAYAAAD0f5bSAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAEVSURBVHgBlVJNTsJgEJ2pW414Az2BpcTEnfUEHkFdkAAbewPxBOpGFywKR+AIrElIuQE3KH/Lto8Z6JfwfUATJpnkS2fevJn3SuTEYyu91aSKYPMIOqtPBkXyrJWlGRj9yd/VlwvydoBlTEAkoF8v47omAwMd0uis4wOqoLV8a7RX8Jup79YemmtfamnQXkQ2E/OHZD/p3SQuaNy7TIBiwOS9WCA5ykdRjOj02TostJmI5lQVBWpuj4ISZn49yXMhqwEjez2QShqq5C6g/BbmlFtCbH1SdeTYb/VGpg7Lyr25BUzdfb+2Pk3+r39yZHcEEUSapemJQNM8y+oA3mWb7rFNKsN4aYB8DlAEi4X1mc4J89dsAC1bciEjZ+CqAAAAAElFTkSuQmCC",trash:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iOCIgaGVpZ2h0PSIxMSIgdmlld0JveD0iMCAwIDggMTEiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+DQo8cGF0aCBkPSJNNi4xNjc4MyAxLjUxODgzSDcuNTUyNDVDNy44MDQyIDEuNTE4ODMgOCAxLjczMzYxIDggMi4wMDk3NlYyLjM2MjYyQzggMi41OTI3NSA3Ljg0NjE1IDIuODA3NTMgNy42NTAzNSAyLjg1MzU2VjEwLjE0MDlDNy42NTAzNSAxMC42MTY1IDcuMjg2NzEgMTEgNi44MzkxNiAxMUgxLjE2MDg0QzAuNzEzMjg3IDExIDAuMzYzNjM2IDEwLjYxNjUgMC4zNjM2MzYgMTAuMTQwOVYyLjg1MzU2QzAuMTY3ODMyIDIuODA3NTMgMCAyLjU5Mjc1IDAgMi4zNjI2MlYyLjAwOTc2QzAgMS43MzM2MSAwLjIwOTc5IDEuNTE4ODMgMC40NjE1MzggMS41MTg4M0gxLjgzMjE3VjAuODc0NDc3QzEuODMyMTcgMC4zOTg4ODQgMi4xODE4MiAwIDIuNjI5MzcgMEg1LjM3MDYzQzUuODE4MTggMCA2LjE2NzgzIDAuMzk4ODg0IDYuMTY3ODMgMC44NzQ0NzdWMS41MTg4M1pNNS4zNzA2MyAwLjc2NzA4NUgyLjYyOTM3QzIuNTU5NDQgMC43NjcwODUgMi41MTc0OCAwLjgxMzExIDIuNTE3NDggMC44NzQ0NzdWMS41MTg4M0g1LjQ4MjUyVjAuODc0NDc3QzUuNDgyNTIgMC44MTMxMSA1LjQ0MDU2IDAuNzY3MDg1IDUuMzcwNjMgMC43NjcwODVaTTEuMzg0NjIgMTAuMDE4MUg2LjYyOTM3QzYuNjg1MzEgMTAuMDE4MSA2LjcyNzI3IDkuOTQxNDIgNi43MjcyNyA5Ljg4MDA2VjIuODY4OUgxLjI3MjczVjkuODgwMDZDMS4yNzI3MyA5Ljk0MTQyIDEuMzE0NjkgMTAuMDE4MSAxLjM4NDYyIDEwLjAxODFaTTIuNDYxNTQgOS40NTA0OUgyLjM3NzYyQzIuMTI1ODcgOS40NTA0OSAxLjkxNjA4IDkuMjIwMzYgMS45MTYwOCA4Ljk0NDIxVjMuOTI3NDhDMS45MTYwOCAzLjY2NjY3IDIuMTI1ODcgMy40NTE4OCAyLjM3NzYyIDMuNDUxODhIMi40NjE1NEMyLjY5OTMgMy40NTE4OCAyLjkwOTA5IDMuNjY2NjcgMi45MDkwOSAzLjkyNzQ4VjguOTQ0MjFDMi45MDkwOSA5LjIyMDM2IDIuNjk5MyA5LjQ1MDQ5IDIuNDYxNTQgOS40NTA0OVpNNC4wNDE5NiA5LjQ1MDQ5SDMuOTcyMDNDMy43MjAyOCA5LjQ1MDQ5IDMuNTEwNDkgOS4yMjAzNiAzLjUxMDQ5IDguOTQ0MjFWMy45Mjc0OEMzLjUxMDQ5IDMuNjY2NjcgMy43MjAyOCAzLjQ1MTg4IDMuOTcyMDMgMy40NTE4OEg0LjA0MTk2QzQuMjkzNzEgMy40NTE4OCA0LjUwMzUgMy42NjY2NyA0LjUwMzUgMy45Mjc0OFY4Ljk0NDIxQzQuNTAzNSA5LjIyMDM2IDQuMjkzNzEgOS40NTA0OSA0LjA0MTk2IDkuNDUwNDlaTTUuNjIyMzggOS40NTA0OUg1LjU1MjQ1QzUuMzAwNyA5LjQ1MDQ5IDUuMTA0OSA5LjIyMDM2IDUuMTA0OSA4Ljk0NDIxVjMuOTI3NDhDNS4xMDQ5IDMuNjY2NjcgNS4zMDA3IDMuNDUxODggNS41NTI0NSAzLjQ1MTg4SDUuNjIyMzhDNS44NzQxMyAzLjQ1MTg4IDYuMDgzOTIgMy42NjY2NyA2LjA4MzkyIDMuOTI3NDhWOC45NDQyMUM2LjA4MzkyIDkuMjIwMzYgNS44NzQxMyA5LjQ1MDQ5IDUuNjIyMzggOS40NTA0OVoiIGZpbGw9IndoaXRlIi8+DQo8L3N2Zz4NCg==",menu:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjIiIGhlaWdodD0iMjIiIHZpZXdCb3g9IjAgMCAyMiAyMiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4NCjxsaW5lIHgxPSIxMC45OTk5IiB5MT0iNS41IiB4Mj0iMTAuOTk5OSIgeTI9IjE2LjUiIHN0cm9rZT0iIzMzNjlGMyIgc3Ryb2tlLXdpZHRoPSIxLjUiLz4NCjxsaW5lIHgxPSI1LjQ5OTg4IiB5MT0iMTEiIHgyPSIxNi40OTk5IiB5Mj0iMTEiIHN0cm9rZT0iIzMzNjlGMyIgc3Ryb2tlLXdpZHRoPSIxLjUiLz4NCjxjaXJjbGUgY3g9IjExIiBjeT0iMTEiIHI9IjEwLjI1IiBzdHJva2U9IiMzMzY5RjMiIHN0cm9rZS13aWR0aD0iMS41Ii8+DQo8L3N2Zz4NCg==",picture:Q,checkMark:"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgaGVpZ2h0PSIxNiIgZmlsbD0iY3VycmVudENvbG9yIiBjbGFzcz0iYmkgYmktY2hlY2syIiB2aWV3Qm94PSIwIDAgMTYgMTYiPg0KICA8cGF0aCBkPSJNMTMuODU0IDMuNjQ2YS41LjUgMCAwIDEgMCAuNzA4bC03IDdhLjUuNSAwIDAgMS0uNzA4IDBsLTMuNS0zLjVhLjUuNSAwIDEgMSAuNzA4LS43MDhMNi41IDEwLjI5M2w2LjY0Ni02LjY0N2EuNS41IDAgMCAxIC43MDggMHoiLz4NCjwvc3ZnPg==",checkMark2:"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgaGVpZ2h0PSIxNiIgZmlsbD0iIzMzNjlGMyIgY2xhc3M9ImJpIGJpLWNoZWNrMi1hbGwiIHZpZXdCb3g9IjAgMCAxNiAxNiI+DQogIDxwYXRoIGQ9Ik0xMi4zNTQgNC4zNTRhLjUuNSAwIDAgMC0uNzA4LS43MDhMNSAxMC4yOTMgMS44NTQgNy4xNDZhLjUuNSAwIDEgMC0uNzA4LjcwOGwzLjUgMy41YS41LjUgMCAwIDAgLjcwOCAwbDctN3ptLTQuMjA4IDctLjg5Ni0uODk3LjcwNy0uNzA3LjU0My41NDMgNi42NDYtNi42NDdhLjUuNSAwIDAgMSAuNzA4LjcwOGwtNyA3YS41LjUgMCAwIDEtLjcwOCAweiIvPg0KICA8cGF0aCBkPSJtNS4zNTQgNy4xNDYuODk2Ljg5Ny0uNzA3LjcwNy0uODk3LS44OTZhLjUuNSAwIDEgMSAuNzA4LS43MDh6Ii8+DQo8L3N2Zz4=",paperclip:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAJeSURBVHgB7VZLctNAEO0eTVKCIpRzA3MCFAPr2CcAnyDJgipn5XACzAkSVnEVC5IT4BvY2VEFqegI4gRWAot8pGm6pRpIXJJsSd7Fb+EZt2bmPbW6expghccOhJp43Zu2CXWfgLz0QAz49ySmuzN/uBnM219ZgHcwbTg3+htP20AwITBnSGoKSFuEsI2gQEXQ/fHlmQ/LFiDk+nZtbMg0FOHez+HG5MHz3rTpoD4UcTFFW0WeKC3gPrmhuFN0eGv/9wUThOfHG528NQpqkovt1f7Vu8zDCT7w0BaP1BaQRy42AjiU+eyeyI38lMRp1xJQRP7PdrQZzu7LspUWsBB5ThxY16skNSsIqEMucJR+y0NoP0UpAXXJk7cnGCDB56JPkSvAuXaO6pA7yMGJEHCNGEABdJYxLa+4g0Dd6uQUmvWoA3OQ6QGu7R+lvJ4fPx/J/1lvwILk4nqx5dUJgc6xtwFxVybWG4aiF1XIrY2XjBYSYFMHiX7JaECJer8OedGnyA3CCKJARq5yDSjAIuTlssCFZLGm9ZcyogGfL5RmVqmtS54pINlAFBhM3WaemhNuNkJ1q8f3LxWJjbrkyQtmGVu9ywGi6tu7XA5W6Iy522ny4wnnd4MLjCeZErtRtyp5rgBxt7pxLqS9snd5IoJvNVRqGwxd8saRbUSqkucKELx5/8czmsY89dkTe3lZkKbp2tcq5IUCBP9dr2TlBM3dKcZpkMYOeIh6B5KekE5jNz4oSz5XgEWrd7XLhanPiz1rk8BEQsmQT7M94dIFWEhsuNduko7fh08CWGGFJeAvsi0jCm5gKwIAAAAASUVORK5CYII=",photo:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjIiIGhlaWdodD0iMjIiIHZpZXdCb3g9IjAgMCAyMiAyMiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4NCjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNNCAxLjVIMThDMTkuMzgwNyAxLjUgMjAuNSAyLjYxOTI5IDIwLjUgNFYxNEwxNC41MTk0IDEyLjQwNTJDMTMuNTEwOCAxMi4xMzYyIDEyLjQ3MTQgMTIgMTEuNDI3NSAxMkgxMC41NzI1QzkuNTI4NjQgMTIgOC40ODkyMSAxMi4xMzYyIDcuNDgwNTcgMTIuNDA1MkwxLjUgMTRWNEMxLjUgMi42MTkyOSAyLjYxOTI5IDEuNSA0IDEuNVpNMCA0QzAgMS43OTA4NiAxLjc5MDg2IDAgNCAwSDE4QzIwLjIwOTEgMCAyMiAxLjc5MDg2IDIyIDRWMThDMjIgMjAuMjA5MSAyMC4yMDkxIDIyIDE4IDIySDRDMS43OTA4NiAyMiAwIDIwLjIwOTEgMCAxOFY0Wk04IDZDOCA3LjEwNDU3IDcuMTA0NTcgOCA2IDhDNC44OTU0MyA4IDQgNy4xMDQ1NyA0IDZDNCA0Ljg5NTQzIDQuODk1NDMgNCA2IDRDNy4xMDQ1NyA0IDggNC44OTU0MyA4IDZaIiBmaWxsPSIjMzM2OUYzIi8+DQo8L3N2Zz4NCg==",file:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjIiIGhlaWdodD0iMjIiIHZpZXdCb3g9IjAgMCAyMiAyMiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4NCjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNNCAxLjVIMThDMTkuMzgwNyAxLjUgMjAuNSAyLjYxOTI5IDIwLjUgNFYxMkgxNkMxMy43OTA5IDEyIDEyIDEzLjc5MDkgMTIgMTZWMjAuNUg0QzIuNjE5MjkgMjAuNSAxLjUgMTkuMzgwNyAxLjUgMThWNEMxLjUgMi42MTkyOSAyLjYxOTI5IDEuNSA0IDEuNVpNMTIgMjJINEMxLjc5MDg2IDIyIDAgMjAuMjA5MSAwIDE4VjRDMCAxLjc5MDg2IDEuNzkwODYgMCA0IDBIMThDMjAuMjA5MSAwIDIyIDEuNzkwODYgMjIgNFYxMlYxOEMyMiAyMC4yMDkxIDIwLjIwOTEgMjIgMTggMjJIMTJaIiBmaWxsPSIjMzM2OUYzIi8+DQo8L3N2Zz4NCg==",send:"data:image/svg+xml;base64,PCFET0NUWVBFIHN2ZyBQVUJMSUMgIi0vL1czQy8vRFREIFNWRyAxLjEvL0VOIiAiaHR0cDovL3d3dy53My5vcmcvR3JhcGhpY3MvU1ZHLzEuMS9EVEQvc3ZnMTEuZHRkIj4KDTwhLS0gVXBsb2FkZWQgdG86IFNWRyBSZXBvLCB3d3cuc3ZncmVwby5jb20sIFRyYW5zZm9ybWVkIGJ5OiBTVkcgUmVwbyBNaXhlciBUb29scyAtLT4KPHN2ZyBmaWxsPSIjMDAwMDAwIiB3aWR0aD0iNjRweCIgaGVpZ2h0PSI2NHB4IiB2aWV3Qm94PSIwIDAgMjQgMjQiIGlkPSJzZW5kIiBkYXRhLW5hbWU9IkZsYXQgTGluZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiBjbGFzcz0iaWNvbiBmbGF0LWxpbmUiPgoNPGcgaWQ9IlNWR1JlcG9fYmdDYXJyaWVyIiBzdHJva2Utd2lkdGg9IjAiLz4KDTxnIGlkPSJTVkdSZXBvX3RyYWNlckNhcnJpZXIiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIvPgoNPGcgaWQ9IlNWR1JlcG9faWNvbkNhcnJpZXIiPgoNPHBhdGggaWQ9InNlY29uZGFyeSIgZD0iTTUuNDQsNC4xNWwxNC42NSw3YTEsMSwwLDAsMSwwLDEuOGwtMTQuNjUsN0ExLDEsMCwwLDEsNC4xLDE4LjU0bDIuNzItNi4xM2ExLjA2LDEuMDYsMCwwLDAsMC0uODJMNC4xLDUuNDZBMSwxLDAsMCwxLDUuNDQsNC4xNVoiIHN0eWxlPSJmaWxsOiAjMzM2OWYzOyBzdHJva2Utd2lkdGg6IDI7Ii8+Cg08cGF0aCBpZD0icHJpbWFyeSIgZD0iTTcsMTJoNE00LjEsNS40NmwyLjcyLDYuMTNhMS4wNiwxLjA2LDAsMCwxLDAsLjgyTDQuMSwxOC41NGExLDEsMCwwLDAsMS4zNCwxLjMxbDE0LjY1LTdhMSwxLDAsMCwwLDAtMS44TDUuNDQsNC4xNUExLDEsMCwwLDAsNC4xLDUuNDZaIiBzdHlsZT0iZmlsbDogbm9uZTsgc3Ryb2tlOiAjZmZmOyBzdHJva2UtbGluZWNhcDogcm91bmQ7IHN0cm9rZS1saW5lam9pbjogcm91bmQ7IHN0cm9rZS13aWR0aDogMjsiLz4KDTwvZz4KDTwvc3ZnPg=="};class ae extends w{constructor(e){super({...e})}init(){$.fetchChats(),this.children.list=new X({}),this.children.messages=new ie({}),this.children.link=new P({text:"Профиль",classes:"chats",href:"/profile"}),this.children.photoOrVideo=new P({text:"Фото или Видео",classes:"chats",href:"/messenger/addPhotoOrVideo",li:!0}),this.children.file=new P({text:"Файл",classes:"chats",href:"/messenger/addFile",li:!0}),this.children.addUser=new P({text:"Добавить пользователя",classes:"chats",href:"/messenger/addUser",li:!0}),this.children.deleteUser=new P({text:"Удалить пользователя",classes:"chats",href:"/messenger/deleteUser",li:!0}),this.children.search=new k({name:"search",classes:"chats",type:"text",placeholder:"Поиск",events:{input:e=>{const t=e.target,n=new RegExp(`^${t.value}`,"i"),s=p.getState().chats.filter((e=>n.test(e.title)));p.set("search",s)}}}),this.children.message=new k({name:"message",classes:"chats__message-input chats",type:"text",placeholder:"Сообщение"}),this.children.button=new b({label:"",classes:"chats__message-send chats",type:"submit",events:{click:e=>{const t=document.querySelector(".chats__message-form"),n=t?.querySelectorAll("input");if(e.preventDefault(),n)for(let e=0;e<n.length;e++)if(""===n[e].value)return;if(t){const e=new FormData(t).get("message");n[0].value="",H.sendMessage(p.getState().selectedChat,e)}}}})}render(){return this.compile(R(),{...this.props})}}const oe=d((e=>({...e.user,...e.selectedChat})))(ae);var ce=n(786),le=n.n(ce);class ue extends w{constructor(){super({})}init(){this.children.login=new k({name:"login",classes:"entrance",type:"text"}),this.children.password=new k({name:"password",classes:"entrance",type:"password"}),this.children.button=new b({label:"Авторизоваться",classes:"entrance",type:"submit",events:{click:this.onSubmit}}),this.children.link=new P({text:"Нет аккаунта?",classes:"entrance",href:"/sign-up"})}onSubmit(e){const t=document.querySelector(".entrance__form"),n=t?.querySelectorAll("input");if(e.preventDefault(),n)for(let e=0;e<n.length;e++)if(n[e].classList.contains("validation")||""===n[e].value)return;if(t){const e=new FormData(t),n={login:e.get("login"),password:e.get("password")};Le.signin({data:n,headers:{"Content-Type":"application/json"}})}}render(){return this.compile(le(),{...this.props})}}var de=n(93),pe=n.n(de);class he extends w{constructor(e){super({...e})}init(){this.children.input=new k({name:this.props.name,classes:"popup__input popup",id:this.props.id,type:this.props.typeInput}),this.children.button=new b({label:this.props.label,classes:"popup",type:this.props.typeButton})}render(){return this.compile(pe(),{...this.props})}}const ge=(e,t)=>{const n=document.querySelector(`#popup__${t} form`),s=n?.querySelectorAll("input");if(e.preventDefault(),s)for(let e=0;e<s.length;e++)if(s[e].classList.contains("validation")||""===s[e].value)return;if(n){const e=new FormData(n);if("add"===t){const t=e.get("login");$.create(t,s[0])}else if("avatar"===t){const e=new FormData,t=s[0];e.append("avatar",t.files?.item(0)),Le.changeAvatar(e)}else if("delete"===t){const t=p.getState().chats.find((t=>t.title===e.get("login"))).id;$.delete(t,s[0])}}};var fe=n.p+"images/error.jpg",me=n(821),ye=n.n(me);const ve=d((e=>({...e.user})))(class extends w{constructor(e){super({...e})}init(){Le.fetchUser(),this.children.chat=new P({text:"Чат",classes:"profile",href:"/messenger",li:!0}),this.children.profile=new P({text:"Профиль",classes:"profile__menu-active profile",href:"/profile",li:!0}),this.children.data=new P({text:"Изменить данные",classes:"profile",href:"/profile/data",li:!0}),this.children.password=new P({text:"Изменить пароль",classes:"profile",href:"/profile/password",li:!0}),this.children.exit=new P({text:"Выйти",classes:"profile",href:"#",li:!0})}render(){return this.compile(ye(),{...this.props})}});var Me=n(603),Ie=n.n(Me);class we extends w{constructor(e){super({...e})}init(){this.children.email=new k({name:"email",classes:"registration",type:"email"}),this.children.login=new k({name:"login",classes:"registration",type:"text"}),this.children.first_name=new k({name:"first_name",classes:"registration",type:"first_name"}),this.children.second_name=new k({name:"second_name",classes:"registration",type:"text"}),this.children.phone=new k({name:"phone",classes:"registration",type:"tel"}),this.children.password=new k({name:"password",classes:"registration",type:"password"}),this.children.passwordReplay=new k({name:"passwordRepeat",classes:"registration",type:"password"}),this.children.button=new b({label:"Зарегистрироваться",classes:"registration",type:"submit"}),this.children.link=new P({text:"Войти",classes:"registration",href:"/"})}render(){return this.compile(Ie(),{...this.props})}}const Ae=e=>{e.preventDefault();const t=document.querySelector(".registration__form"),n=t?.querySelectorAll("input");if(n)for(let e=0;e<n.length;e++)if(n[e].classList.contains("validation")||""===n[e].value)return;if(t){const e=new FormData(t),n={email:e.get("email"),login:e.get("login"),first_name:e.get("first_name"),second_name:e.get("second_name"),phone:e.get("phone"),password:e.get("password")};Le.signup({headers:{"Content-Type":"application/json"},data:n})}};class Ne{block=null;constructor(e,t,n,s){this.pathname=e,this.blockClass=t,this.query=n,this.props=s}leave(){this.block=null}match(e){return t=e,n=this.pathname,t===n;var t,n}render(e=this.query){if(!this.block)return this.block=new this.blockClass(this.props),void function(e,t){const n=document.querySelector(e);if(null===n)throw new Error(`root not found by selector "${e}"`);t instanceof ae&&document.querySelector(".popup")||t instanceof ve&&document.querySelector(".popup")?document.querySelector(".popup")?.remove():t instanceof he?n.append(t.getContent()):t instanceof ve&&document.querySelector(".profile")||(t instanceof ve?(n.innerHTML="",n.append(t.getContent())):t instanceof E?(document.querySelector(".profile__content")?.remove(),n.append(t.getContent())):(n.innerHTML="",n.append(t.getContent())))}(e,this.block)}}class be{routes=[];currentRoute=null;history=window.history;constructor(e){if(this.rootQuery=e,be.__instance)return be.__instance;this.routes=[],be.__instance=this}use(e,t,n={}){const s=new Ne(e,t,this.rootQuery,n);return this.routes.push(s),this}start(){window.onpopstate=e=>{const t=e.currentTarget;this._onRoute(t.location.pathname)},this._onRoute(window.location.pathname)}_onRoute(e){if(this.routes.find((t=>t.match(e)))){this.getRoute(e).forEach((e=>{if(!e)return;this.currentRoute&&this.currentRoute!==e&&this.currentRoute.leave(),this.currentRoute=e;e.blockClass===he?e.render("body"):e.render()}))}else"/"===e||"/sign-up"===e?this.go("/messenger"):this.go("/error404")}go(e){this.history.pushState({},"",e),this._onRoute(e)}back(){this.history.back()}forward(){this.history.forward()}getRoute(e){return this.routes.filter((t=>t.match(e)))}}var _e,De=new be("#app"),xe=n(918),je=n.n(xe);class Se extends w{constructor(e){super({...e})}init(){this.children.button=new b({label:"Назад",classes:"error404",events:{click:()=>history.go(-2)}})}render(){return this.compile(je(),{...this.props})}}!function(e){e.Index="/",e.Register="/sign-up",e.Chats="/messenger",e.AddFile="/messenger/addFile",e.addPhotoOrVideo="/messenger/addPhotoOrVideo",e.addUser="/messenger/addUser",e.deleteUser="/messenger/deleteUser",e.Profile="/profile",e.ChangesData="/profile/data",e.ChangePassword="/profile/password",e.ChangeAvatar="/profile/changeAvatar",e.Error404="/error404"}(_e||(_e={}));class ke{activation=()=>{De.use(_e.Chats,oe,{classes:"chats",images:re}).use(_e.AddFile,ae,{classes:"chats",images:re}).use(_e.AddFile,he,{title:"Загрузите файл",name:"file",label:"Добавить",id:"file",events:{submit:e=>ge(e,"file")},typeButton:"submit",typeInput:"file"}).use(_e.addPhotoOrVideo,oe,{classes:"chats",images:re}).use(_e.addPhotoOrVideo,he,{title:"Загрузите файл",name:"file",label:"Добавить",id:"file",events:{submit:e=>ge(e,"file")},typeButton:"submit",typeInput:"file"}).use(_e.addUser,oe,{classes:"chats",images:re}).use(_e.addUser,he,{title:"Добавить пользователя",name:"login",label:"Добавить",id:"add",events:{submit:e=>ge(e,"add")},typeButton:"submit",typeInput:"text"}).use(_e.deleteUser,oe,{classes:"chats",images:re}).use(_e.deleteUser,he,{title:"Удалить пользователя",name:"login",label:"Удалить",id:"delete",events:{submit:e=>ge(e,"delete")},typeButton:"submit",typeInput:"text"}).use(_e.Profile,ve,{events:{click:this.onClick}}).use(_e.ChangesData,ve,{events:{click:this.onClick}}).use(_e.ChangePassword,ve,{events:{click:this.onClick}}).use(_e.ChangeAvatar,ve,{events:{click:this.onClick}}).use(_e.Profile,E,{trigger:"profile"}).use(_e.ChangesData,E,{trigger:"data",events:{submit:e=>T(e,"data")}}).use(_e.ChangePassword,E,{trigger:"password",events:{submit:e=>T(e,"password")}}).use(_e.ChangeAvatar,he,{title:"Загрузите файл",name:"file",label:"Поменять",id:"avatar",events:{submit:e=>ge(e,"avatar")},typeButton:"submit",typeInput:"file"}).use(_e.Error404,Se,{images:fe}).start()};activationForNonRegistered=()=>{De.use(_e.Index,ue).use(_e.Register,we,{classes:"registration",events:{submit:Ae}}).use(_e.Error404,Se,{images:fe}).start()};onClick=e=>{e.preventDefault();const t=e.target;if("#"===t.getAttribute("href"))return void Le.logout();let n=t.getAttribute("href")?t.getAttribute("href"):t.getAttribute("data-href");if("/#"!==t.getAttribute("data-href")){if(!t.classList.contains("profile__hover")&&/profile/g.test(t.getAttribute("class"))&&"A"===t.tagName){const e=document.querySelector(".profile"),n=e?.querySelectorAll("a");n?.forEach((e=>{e.classList.remove("profile__menu-active")})),t.classList.add("profile__menu-active")}n&&De.go(n)}else/profile/g.test(window.location.pathname)?De.go("/profile"):De.go("/messenger")}}const Le=new class{constructor(){this.api=s}async signin(e){await this.api.signin(e).then((()=>{this.fetchUser()})).then((()=>{(new ke).activation()})).then((()=>De.go("/messenger"))).catch((e=>console.log(e)))}async signup(e){await this.api.signup(e).then((()=>{this.fetchUser()})).then((()=>(new ke).activation())).then((()=>De.go("/messenger"))).catch((e=>console.log(e)))}async changeDate(e){this.api.changeDate({headers:{"Content-Type":"application/json",accept:"application/json"},data:e}).then((e=>{p.set("user",e)})).catch((e=>console.log(e)))}async changePassword(e){this.api.changePassword({headers:{"Content-Type":"application/json",accept:"application/json"},data:e}).then((e=>console.log(e))).catch((e=>console.log(e)))}async changeAvatar(e){this.api.changeAvatar({data:e}).then((e=>p.set("user",e))).then((()=>{document.querySelector("#popup__avatar").style.display="none"})).catch((e=>console.log(e)))}async fetchUser(){const e=await this.api.read();p.set("user",e)}async logout(){try{await this.api.logout(),(new ke).activationForNonRegistered(),De.go("/")}catch(e){console.error(e.message)}}};window.addEventListener("DOMContentLoaded",(async()=>{const e=new ke;/profile/g.test(location.pathname)&&function(){const e=document.querySelector(".profile__menu"),t=e?.querySelectorAll("a");t?.forEach((e=>{e.classList.remove("profile__menu-active"),"/profile"===location.pathname&&"Профиль"===e.textContent&&e.classList.add("profile__menu-active"),"/profile/data"===location.pathname&&"Изменить данные"===e.textContent&&e.classList.add("profile__menu-active"),"/profile/password"===location.pathname&&"Изменить пароль"===e.textContent&&e.classList.add("profile__menu-active")}))}();try{await Le.fetchUser(),e.activation()}catch(t){e.activationForNonRegistered()}}))}()}();